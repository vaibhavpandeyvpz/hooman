# Redis for BullMQ event queue. Start with: docker compose up -d redis
services:
  ngrok:
    image: ngrok/ngrok
    command:
      - start
      - --all
      - --config
      - /etc/ngrok.yml
    ports:
      - "4040:4040"
    profiles:
      - remote
    volumes:
      - ./ngrok.yml:/etc/ngrok.yml
    env_file:
      - .env
    extra_hosts:
      - host.docker.internal:host-gateway

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 5s
      timeout: 3s
      retries: 5

  chroma:
    image: chromadb/chroma
    ports:
      - "8000:8000"
    volumes:
      - chroma-data:/chroma/chroma
    environment:
      - IS_PERSISTENT=TRUE
      - ANONYMIZED_TELEMETRY=FALSE

volumes:
  chroma-data:
  redis-data:
